<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Mister 36 Outlet Inventory</title>
  <style>
    .container { display: flex; gap: 50px; flex-wrap: wrap; }
    .page { width: 45%; border: 1px solid #aaa; padding: 10px; box-sizing: border-box; }
    h1, h2, h3 { text-align: center; margin: 10px 0; }
    ul { list-style: none; padding-left: 10px; margin: 0; }
    li { background: #f0f0f0; padding: 8px; margin: 5px 0; cursor: pointer; border-radius: 5px; }
    li:hover { background: #d0e0ff; }
    .folder { margin: 10px 0; padding: 5px; background: #f7f7f7; border: 1px dashed #aaa; border-radius: 4px; }
    .hint { font-size: 12px; text-align: center; opacity: 0.75; margin-top: -5px; }
  </style>
</head>
<body>

<h1>Mister 36 Outlet Inventory</h1>
<div class="hint">Click an item to move it between <b>Items</b> and <b>Items To Buy</b>. Saved automatically.</div>

<div class="container">
  <!-- Items Page -->
  <div class="page">
    <h2>Items</h2>
    <div id="foldersA"></div>
  </div>

  <!-- Items to Buy Page -->
  <div class="page">
    <h2>Items To Buy</h2>
    <div id="foldersB"></div>
    <h3 id="totalPrice">Total: RM 0.00</h3>
    <button id="clearBtn" style="width:100%; padding:10px; cursor:pointer;">Clear Items To Buy</button>
  </div>
</div>

<script>
// =====================
// DATA (use qty here)
// =====================
const items = {
  "Frozen food": {
    "Hotdogs": { price: 18.00, qty: 1 },
    "Nuggets": { price: 14.50, qty: 1 },
    "Fries üçü": { price: 5.50, qty: 2 }
  },
  "Burger": {
    "Bun": { price: 3.00, qty: 3 },
    "Coral": { price: 5.00, qty: 1 },
    "Timun ü•í": { price: 3.00, qty: 1 },
    "Butter üßà": { price: 8.00, qty: 1 },
    "Sliced Cheese üßÄ": { price: 16.60, qty: 1 },
    "Tissue": { price: 1.00, qty: 1 },
    "Kicap": { price: 6.50, qty: 1 },
    "Wrap": { price: 5.20, qty: 2 }  // <-- instead of duplicate keys
  },
  "Nasi Lemak": {
    "Kelapa Parut": { price: 3.00, qty: 2 },
    "Nuts ü•ú": { price: 8.00, qty: 1 },
    "Ikan Bilis": { price: 28.00, qty: 1 },
    "Dry Cili": { price: 7.00, qty: 1 },
    "Cukup Rasa": { price: 4.00, qty: 1 },
    "Lemon Grass": { price: 2.00, qty: 1 },
    "Rice üåæ": { price: 19.00, qty: 1 },
    "Aji namoto": { price: 5.00, qty: 1 },
    "Asam Jawa": { price: 3.00, qty: 1 },
    "Garam": { price: 3.00, qty: 1 },
    "Gula Pasir": { price: 3.00, qty: 1 },
    "Cuka": { price: 3.00, qty: 1 },
    "Cube Ikan Bilis": { price: 5.00, qty: 1 },
    "Belacan": { price: 3.00, qty: 1 },
    "Bawang Merah": { price: 5.00, qty: 1 },
    "Bawang Putih": { price: 3.00, qty: 1 },
    "Pandan Leaves üçÉ": { price: 2.00, qty: 1 }
  },
  "Ayam Gunting": {
    "Chicken UN üçó": { price: 45.00, qty: 1 },
    "Chicken Popcorn üçø": { price: 23.00, qty: 1 },
    "Chicken CF üçó": { price: 43.00, qty: 1 }
  },
  "Lemon Soda üçã": {
    "Soda ü•§": { price: 3.00, qty: 5 },
    "Plastic Bottel üçæ (10 pcs)": { price: 7.50, qty: 1 },
    "SunQuick": { price: 14.00, qty: 1 },
    "Lime üçã": { price: 2.00, qty: 1 },
    "Ice cube üßä": { price: 3.50, qty: 2 },
    "Pudina": { price: 2.00, qty: 1 },
    "Chia Seed": { price: 7.50, qty: 1 }
  },
  "SOS": {
    "Mayo": { price: 10.90, qty: 1 },
    "Cili": { price: 6.00, qty: 1 },
    "BBQ": { price: 9.00, qty: 1 },
    "Cheese üßÄ": { price: 16.00, qty: 1 }
  },
  "Plastic": {
    "P.Small": { price: 2.00, qty: 1 },
    "P.Medium": { price: 3.00, qty: 1 },
    "P.Big": { price: 4.00, qty: 1 },
    "Cup Set": { price: 15.00, qty: 1 },
    "Straw": { price: 3.00, qty: 1 },
    "S.Container small": { price: 6.00, qty: 1 },
    "S.Container big": { price: 5.00, qty: 1 },
    "Spoon ü•Ñ": { price: 3.00, qty: 1 },
    "Garbage Bag üóëÔ∏è üíº": { price: 4.00, qty: 1 },
    "Cup Plastic ü•§": { price: 2.00, qty: 1 }
  },
  "Flour": {
    "Starch": { price: 2.00, qty: 2 }, // <-- qty instead of duplicate keys
    "Bestari flour": { price: 9.00, qty: 1 },
    "W.Papper": { price: 8.00, qty: 1 },
    "Salt üßÇ": { price: 2.00, qty: 1 },
    "Cili Powder": { price: 27.00, qty: 1 },
    "Paprika": { price: 31.00, qty: 1 }
  },
  "Others": {
    "Lunchbox": { price: 10.00, qty: 1 },
    "Styrofoam": { price: 9.00, qty: 1 },
    "Stick ü¶Ø": { price: 3.00, qty: 1 },
    "Rubber band": { price: 1.60, qty: 1 },
    "Gloves üß§": { price: 3.00, qty: 1 },
    "Petrol gen": { price: 6.00, qty: 1 },
    "Petrol van üöê ‚õΩÔ∏è": { price: 10.00, qty: 1 },
    "Petrol FZ ‚õΩÔ∏è": { price: 12.00, qty: 1 },
    "2T": { price: 17.00, qty: 1 },
    "Spark plug üîå": { price: 12.00, qty: 1 },
    "Cooking Oil": { price: 7.50, qty: 1 },
    "Eggs ü•ö": { price: 12.00, qty: 1 },
    "Gas ‚õΩÔ∏è": { price: 29.00, qty: 1 },
    "Mask": { price: 10.00, qty: 1 },
    "DishWash": { price: 10.00, qty: 1 },
    "Detergent": { price: 10.00, qty: 1 },
    "Candle": { price: 3.00, qty: 1 },
    "Sambrani": { price: 5.00, qty: 1 },
    "MatchBox": { price: 4.00, qty: 1 },
    "Marker": { price: 2.60, qty: 1 },
    "TubeLight": { price: 9.00, qty: 1 },
    "Handwash": { price: 2.60, qty: 1 },
    "Spark-L": { price: 2.60, qty: 1 }
  }
};

// =====================
// STATE
// Each selected item must be unique even with qty.
// We'll store: { folderId, itemName, idx, price }
// =====================
let selected = JSON.parse(localStorage.getItem("itemsToBuy")) || [];
let total = 0;

function save() {
  localStorage.setItem("itemsToBuy", JSON.stringify(selected));
}

function updateTotal() {
  total = selected.reduce((sum, i) => sum + Number(i.price), 0);
  document.getElementById("totalPrice").innerText = "Total: RM " + total.toFixed(2);
}

function folderIdFromName(folderName) {
  return folderName.replace(/\s+/g, "_");
}

function keyOf(folderId, itemName, idx) {
  return `${folderId}|||${itemName}|||${idx}`;
}

function isSelected(folderId, itemName, idx) {
  return selected.some(i => keyOf(i.folderId, i.name, i.idx) === keyOf(folderId, itemName, idx));
}

// Move one LI item between lists
function moveItem(li, folderName, itemName, price, toBuy, idx) {
  const folderId = folderIdFromName(folderName);

  const fromList = document.getElementById(folderId + "_" + (toBuy ? "A" : "B"));
  const toList   = document.getElementById(folderId + "_" + (toBuy ? "B" : "A"));

  if (!fromList || !toList) return;

  fromList.removeChild(li);
  toList.appendChild(li);

  if (toBuy) {
    selected.push({ folderId, name: itemName, idx, price });
    li.onclick = () => moveItem(li, folderName, itemName, price, false, idx);
  } else {
    selected = selected.filter(i => keyOf(i.folderId, i.name, i.idx) !== keyOf(folderId, itemName, idx));
    li.onclick = () => moveItem(li, folderName, itemName, price, true, idx);
  }

  save();
  updateTotal();
}

// Create a folder box in both columns
function createFolder(folderName, itemList) {
  const folderId = folderIdFromName(folderName);

  // A side
  const divA = document.createElement("div");
  divA.className = "folder";
  divA.innerHTML = `<h3>üìÇ ${folderName}</h3><ul id="${folderId}_A"></ul>`;
  document.getElementById("foldersA").appendChild(divA);

  // B side
  const divB = document.createElement("div");
  divB.className = "folder";
  divB.innerHTML = `<h3>üìÇ ${folderName}</h3><ul id="${folderId}_B"></ul>`;
  document.getElementById("foldersB").appendChild(divB);

  // Items
  for (const [itemName, obj] of Object.entries(itemList)) {
    const price = Number(obj.price);
    const qty = Number(obj.qty || 1);

    for (let idx = 0; idx < qty; idx++) {
      const li = document.createElement("li");
      li.textContent = `${itemName} - RM${price.toFixed(2)}`;

      const selectedAlready = isSelected(folderId, itemName, idx);
      li.onclick = () => moveItem(li, folderName, itemName, price, !selectedAlready, idx);

      document.getElementById(`${folderId}_${selectedAlready ? "B" : "A"}`).appendChild(li);
    }
  }
}

// Render all folders
function renderAll() {
  document.getElementById("foldersA").innerHTML = "";
  document.getElementById("foldersB").innerHTML = "";

  for (const [folderName, itemList] of Object.entries(items)) {
    // Normalize: ensure every item is {price, qty}
    const normalized = {};
    for (const [name, v] of Object.entries(itemList)) {
      if (typeof v === "number") normalized[name] = { price: v, qty: 1 };
      else normalized[name] = { price: v.price, qty: v.qty || 1 };
    }
    createFolder(folderName, normalized);
  }

  updateTotal();
}

// Clear selected list
document.getElementById("clearBtn").onclick = () => {
  selected = [];
  save();
  renderAll();
};

renderAll();
</script>

</body>
</html>
